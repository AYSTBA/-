# -
文本、文件多算法加密集成系统
1. 设计背景与目标
随着网络攻击手段的不断演进，传统固定算法的加密系统面临逆向分析、侧信道攻击及量子计算的潜在威胁。本系统旨在构建一个动态可调、强度可扩展的混合加密平台，融合现代密码学与混沌理论，通过外部配置机制实现算法行为的灵活变更，从而极大提升攻击者逆向工程的难度。系统支持文本及任意二进制文件（图片、文档等）的加密与解密，私钥长度仅64字符，兼顾安全性与便携性。

2. 系统总体架构
系统由三个层次组成：

密钥封装层：采用椭圆曲线集成加密方案（ECIES），安全传输加密所需的混沌种子。

混沌加密层：基于种子生成高度不可预测的伪随机密钥流，并对每个字节应用多种可逆变换，配合反馈模式实现扩散。

配置管理层：通过外部JSON文件定义所有加密参数，允许动态调整算法行为而无需修改代码。

加解密双方需持有相同的配置文件，发送方使用接收方公钥加密种子，混沌引擎加密数据；接收方用私钥解密种子后逆向恢复明文。

3. 核心加密算法体系
3.1 椭圆曲线密钥封装
系统选用NIST P-256标准曲线，其安全性相当于3072位RSA。私钥为一个32字节整数（表示为64个十六进制字符），公钥为65字节未压缩格式（130字符）。密钥封装过程遵循ECIES标准：

发送方生成临时ECC密钥对，计算与接收方公钥的椭圆曲线点乘，得到共享秘密。

取共享秘密的x坐标，经HKDF-SHA256派生为AES-256密钥。

使用AES-GCM模式加密随机生成的32字节混沌种子，附加12字节随机数和16字节认证标签。

最终输出包含临时公钥、随机数、认证标签和密文的封装包（共125字节），确保种子的机密性、完整性和前向安全性。

3.2 混沌序列生成器
混沌映射对初始条件极端敏感，是生成密钥流的理想选择。系统混合两种经典映射：

Logistic映射：
x
n
+
1
=
r
x
n
(
1
−
x
n
)
x 
n+1
​
 =rx 
n
​
 (1−x 
n
​
 )，当控制参数 
r
r 接近4时处于混沌状态。

Tent映射：x
n
+
1
=
r
x
n
(
1
−
x
n
)
x 
n+1
​
 =rx 
n
​
 (1−x 
n
​
 )，参数 
μ
μ 接近2时混沌性最强。
生成过程以混沌种子和字节位置索引为输入，经SHA-512派生两个浮点数初始值，迭代映射并混合输出字节流。通过配置文件可独立调节 
r
r 和 
μ
μ 值，从而改变密钥流的统计特性，使攻击者无法预知混沌轨迹。

3.3 16种可逆字节变换
每个明文字节在加密时，根据密钥流字节选择操作类型（0至15）并获取参数（低4位），应用以下一类或多类可逆变换：

算术运算：加、减、异或、乘法（参数强制为奇数以保证可逆）。

位运算：循环左移/右移、按位取反、半字节交换（高低4位互换）。

仿射变换：
y
=
(
a
⋅
x
+
b
)
m
o
d
 
 
256
y=(a⋅x+b)mod256，其中 
a
a 为奇数（可逆）。

动态S盒：基于种子和位置生成256字节随机置换，实现非线性替代。

反馈依赖：与前一个密文字节进行加、异或或移位操作，使变换结果依赖于上下文。

乘法逆元：当明文为零时保持不变，否则乘以奇数，解密时使用预计算的逆元恢复。

这16种操作覆盖了代数、位级、查表和反馈等多种类型，确保每个字节的加密方式随机且可逆，攻击者无法通过统计规律推测变换关系。

3.4 密文反馈模式
系统采用密文反馈（CFB）模式增强扩散性：每个字节加密前，基于混沌种子和之前所有密文（取最近若干字节）生成密钥流字节，再与明文变换后的中间值异或得到最终密文。这种设计使得单个明文位的变化会迅速传播到后续所有密文，有效抵抗差分分析。初始向量由混沌种子派生并随密文存储。

4. 可配置机制设计
系统核心创新在于通过外部JSON文件动态定义算法参数，实现“算法即配置”。配置文件包含以下关键部分：

混沌参数：Logistic映射的 
r
r 值（范围3.57~4）、Tent映射的 
μ
μ 值（0~2）及哈希函数类型，直接影响密钥流复杂度。

操作集合与概率：allowed数组列出本次加密允许使用的操作编号（0-15），probabilities数组定义各操作被选中的概率（可为均匀分布或自定义），从而灵活调整加密行为的偏好。例如，可仅启用基于反馈的复杂操作（8-15），大幅提升破解难度。

模式与初始向量长度：当前支持CFB模式，IV长度可配置（默认16字节），更长IV可减少重复模式。

通过修改配置文件，用户可创造出无数种算法变体，如“全复杂操作高混沌版”、“侧重S盒版本”等，使攻击者无法预知确切变换规则。加解密双方必须使用相同配置，否则无法还原。

5. 使用流程与交互
系统提供命令行交互菜单，所有操作均通过文本框或文件路径完成：

密钥生成：生成ECC密钥对，输出私钥（64字符）和公钥（130字符）。用户需妥善保管私钥，公钥可分发。

文本加密：输入接收方公钥和明文，系统返回十六进制密文（包含ECIES封装包和混沌加密数据）。

文件加密：指定接收方公钥和文件路径，系统生成加密文件（后缀.enc）。

解密：输入私钥和密文（文本或文件路径），系统还原原始数据。

配置管理：可查看当前配置、保存到文件或从文件加载新配置，实现算法动态切换。

6. 安全性与扩展性分析
抗分析能力：混沌映射的敏感性、16种可逆变换的随机选择、CFB反馈模式以及可配置机制共同构成多重防护，使密文无统计规律，抵抗已知明文、选择明文及差分攻击。

密钥安全：ECC P-256提供强于RSA-3072的安全性，ECIES封装确保混沌种子仅私钥持有者可解密。

灵活扩展：配置文件可随时调整，若需新增操作类型，仅需扩展代码中的操作分支，现有配置机制无缝兼容。

7. 总结
本系统通过混沌理论与现代密码学的深度融合，结合动态配置机制，打造了一个高度灵活且强度可调的加密平台。用户无需编程即可定制专属算法，极大提升了数据安全性，适用于对隐私保护有极致要求的场景。
